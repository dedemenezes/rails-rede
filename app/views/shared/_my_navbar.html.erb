<nav class="navbar sticky-top bg-body navbar-visitor navbar-light navbar-expand-lg py-2"
     data-controller="css-classes"
     data-action="scroll@window->css-classes#onScroll"
     data-css-classes-scrolling-class="shadow-elevation-2">
  <div class="container">
    <%= link_to root_path, class: 'navabar-top-logo' do %>
      <%= image_tag 'Logo_PEA.png', width: '186px', alt: 'Logo do PEA Rede Observação' %>
    <% end %>
    <button class="navbar-toggler btn-nav position-absolute end-0" type="button" data-bs-toggle="offcanvas" data-bs-target="#menuMobile" aria-controls="menuMobile" aria-label="Toggle navigation">
      <i class="fas fa-bars"></i>
    </button>
    <%# laptop nav seen after lg breakpoint %>
    <div class="d-none d-lg-flex flex-grow-1">
      <ul class="navbar-nav d-flex align-items-center justify-content-evenly flex-grow-1">
        <%= render NavItemComponent.new do %>
          <%= render NavLinkComponent.new("Sobre", about_us_path) %>
        <% end %>

        <%= render NavItemComponent.new do %>
          <%= render NavLinkComponent.new("Mapa", mapa_observatories_path) %>
        <% end %>

        <li class="dropdown position-inherit">
          <%= render Dropdown::TogglerComponent.new("Observatórios", toggler_id: 'observatory-dropdown-toggler') %>
          <%= render Dropdown::ContentComponent.new do %>
            <%= turbo_frame_tag "nav-observatories", src: navbar_observatories_path, loading: "lazy" do %>
              <div class="d-flex align-items-center justify-content-center py-4">
                <div class="spinner-border text-primary" role="status"></div>
              </div>
            <% end %>
          <% end %>
        </li>

        <%# Acervo %>
        <li class="dropdown position-inherit">
          <%= render Dropdown::TogglerComponent.new("Acervos") %>
          <%= render Dropdown::ContentComponent.new(extra_class: "d-flex") do %>
            <div class="d-flex">
              <div class="d-flex flex-columns justify-content-between pe-0" style="padding-top: 2rem !important; padding-bottom: 2rem !important;">
                <!-- Nav tabs -->
                <ul class="nav d-inline-flex flex-column align-items-start nav-pills nav-tabs border-bottom-0" style="min-width: 216px" id="myTab" role="tablist">
                  <li class="mb-lg-3 w-100">
                    <%= render Dropdown::TabButtonComponent.new("Audiovisuais", id: 'videos-tab', target: 'nav-videos', is_active: true) %>
                  </li>
                  <li class="mb-lg-3 w-100">
                    <%= render Dropdown::TabButtonComponent.new("Imagens", id: 'images-tab', target: 'nav-images') %>
                  </li>
                  <li class="mb-lg-3 w-100">
                    <%= render Dropdown::TabButtonComponent.new("Materiais", id: 'materials-tab', target: 'nav-materials') %>
                  </li>
                </ul>
              </div>

              <!-- Tab panes -->
              <div class="tab-content flex-grow-1">
                <%= render Dropdown::TabContentComponent.new(
                  "Carregando videos...",
                  navbar_videos_path,
                  frame_id: "nav-videos",
                  aria_labelledby: "videos-tab",
                  index: 0,
                  active: true
                ) %>
                <%= render Dropdown::TabContentComponent.new(
                  "Carregando photos...",
                  navbar_images_path,
                  frame_id: "nav-images",
                  aria_labelledby: "images-tab",
                  index: 1
                ) %>
                <%= render Dropdown::TabContentComponent.new(
                  "Carregando materiais...",
                  navbar_materials_path,
                  frame_id: "nav-materials",
                  aria_labelledby: "materials-tab",
                  index: 2
                ) %>
              </div>
            </div>
          <% end %>
        </li>

        <%= render NavItemComponent.new do %>
          <%= render NavLinkComponent.new("Notícias", articles_path) %>
        <% end %>

        <%= render NavItemComponent.new do %>
          <%= render NavLinkComponent.new("Contato", new_contact_path) %>
        <% end %>
      </ul>
      <ul class="navbar-nav navbar-social">
        <% @social_urls.each do |social, link| %>
          <%= render NavItemComponent.new do %>
            <%= render NavLinkComponent.new(icon('fa-brands', social.to_s), "https://www.#{social.to_s}.com/#{link}/", css_class: 'fs-4 rede-link') %>
          <% end %>
        <% end %>
      </ul>
    </div>
    <%# Mobile nav hidden after lg breakpoint %>
    <div class="d-block d-lg-none">
      <%= render "shared/navbar_mobile" %>
    </div>
  </div>
</nav>
